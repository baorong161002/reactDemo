(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{769:function(e,t,n){},896:function(e,t,n){"use strict";n.r(t);n(104);var a=n(10),s=n.n(a),i=(n(97),n(81)),l=n.n(i),o=(n(490),n(479)),c=n.n(o),h=(n(767),n(770)),r=n.n(h),u=(n(212),n(105)),d=n.n(u),p=n(188),b=n(19),m=n(20),E=n(22),g=n(18),C=n(21),v=n(1),y=n.n(v),f=n(491),M=n.n(f),S=(n(769),function(e){function t(e){var n;return Object(b.a)(this,t),(n=Object(E.a)(this,Object(g.a)(t).call(this,e))).state={btnOpenDisabled:!1,btnCloseDisabled:!0,btnSendDisabled:!0,btnSubDisabled:!0,host:"192.168.136.148",port:9e3,clientId:"webMqttClient",ssl:"0",mqttTopic:"World",mqttMessage:"Hello",mqttQos:"0",mqttRetain:"0",subTopic:"World",subQos:"0"},n.client=null,n.GlobalEnvParams.DEMO_MQTT||(n.state.host="127.0.0.1"),n}return Object(C.a)(t,e),Object(m.a)(t,[{key:"dispalyMesage",value:function(e){var t=!!arguments[1]&&arguments[1],n=document.getElementById("log"),a="msgClient";t&&(a="msgServer"),n.innerHTML="<div class='logitem'>"+(new Date).format("hh:mm:ss S: ")+"<span class='"+a+"'> "+e+"</span></div>"+n.innerHTML}},{key:"clearMessage",value:function(){document.getElementById("log").innerHTML=""}},{key:"controlBtn",value:function(){var e=!1;null!=this.client&&this.client.isConnected()&&(e=!0),this.setState({btnOpenDisabled:e}),this.setState({btnCloseDisabled:!e}),this.setState({btnSendDisabled:!e}),this.setState({btnSubDisabled:!e})}},{key:"publish",value:function(){if(null!=this.client&&this.client.isConnected()){var e=this.state.mqttTopic,t=this.state.mqttMessage,n=this.state.mqttQos,a=Boolean(Number(this.state.mqttRetain)),s=new window.Paho.MQTT.Message(t);s.destinationName=e,s.qos=Number(n),s.retained=a,this.client.send(s)}}},{key:"subscribe",value:function(){if(null!=this.client&&this.client.isConnected()){var e=Number(this.state.subQos),t=this.state.subTopic,n={qos:e};this.client.subscribe(t,n);var a="subscribe - topic:"+t+" qos"+e;this.dispalyMesage(a)}}},{key:"close",value:function(){null!=this.client&&this.client.isConnected()&&(this.client.disconnect(),this.controlBtn())}},{key:"open",value:function(){if(this.controlBtn(),null!=this.client&&this.client.isConnected()&&this.close(),window.WebSocket){var e=this.state.host,t=Number(this.state.port),n=this.state.clientId,a=Boolean(Number(this.state.ssl));this.client=new window.Paho.MQTT.Client(e,t,"/mqtt",n),this.client.onConnectionLost=this.onConnectionLost.bind(this),this.client.onMessageArrived=this.onMessageArrived.bind(this),this.client.connect({onSuccess:this.onConnect.bind(this),useSSL:a}),this.dispalyMesage("connect init...")}else alert("browse not support WebSocket\uff01")}},{key:"onConnect",value:function(){this.dispalyMesage("onConnect - "+this.client.clientId),this.controlBtn(),this.GlobalEnvParams.DEMO_MQTT&&(this.subscribe(),this.publish())}},{key:"onConnectionLost",value:function(e){0!==e.errorCode&&this.dispalyMesage("onConnectionLost -"+e.errorMessage)}},{key:"onMessageArrived",value:function(e){var t="<span>message - topic: "+e.topic+"</span><span> qos"+e.qos+"</span>";t+="<div class='msgContent'>"+e.payloadString+"</div>",this.dispalyMesage(t,!0)}},{key:"handleScriptCreate",value:function(){console.log("handleScriptCreate"),this.setState({scriptLoaded:!1})}},{key:"handleScriptError",value:function(){console.log("handleScriptError"),this.setState({scriptError:!0})}},{key:"handleScriptLoad",value:function(){console.log("handleScriptLoad"),this.setState({scriptLoaded:!0}),this.GlobalEnvParams.DEMO_MQTT&&this.open()}},{key:"componentDidMount",value:function(){}},{key:"handleInputChange",value:function(e,t){var n=null;"string"===typeof t||"number"===typeof t?n=t:"object"==typeof t.target?n=t.target.value:alert("handleInputChange: "+typeof t),e&&null!=n&&this.setState(Object(p.a)({},e,n))}},{key:"render",value:function(){return y.a.createElement("div",{className:""},y.a.createElement(M.a,{url:"./paho-mqtt.js",onCreate:this.handleScriptCreate.bind(this),onError:this.handleScriptError.bind(this),onLoad:this.handleScriptLoad.bind(this)}),y.a.createElement("h2",null,"MQTT WebSocket Client"),y.a.createElement("div",{className:"connect"},y.a.createElement("h3",null,"connect"),y.a.createElement("span",null,y.a.createElement("label",null,"client:"),y.a.createElement(d.a,{style:{width:120},onChange:this.handleInputChange.bind(this,"clientId"),defaultValue:this.state.clientId})),y.a.createElement("span",null,"host:",y.a.createElement(d.a,{style:{width:160},onChange:this.handleInputChange.bind(this,"host"),defaultValue:this.state.host})),y.a.createElement("span",null,"port:",y.a.createElement(r.a,{style:{width:100},onChange:this.handleInputChange.bind(this,"port"),defaultValue:this.state.port})),y.a.createElement("span",null,"ssl:",y.a.createElement(c.a,{defaultValue:this.state.ssl,onChange:this.handleInputChange.bind(this,"ssl")},y.a.createElement(c.a.Option,{value:"0"},"false"),y.a.createElement(c.a.Option,{value:"1"},"true"))),y.a.createElement("span",{className:"btnContainer"},y.a.createElement(l.a,{type:"",disabled:this.state.btnOpenDisabled,onClick:this.open.bind(this)},"open"),y.a.createElement(l.a,{type:"",disabled:this.state.btnCloseDisabled,onClick:this.close.bind(this)},"close"))),y.a.createElement("div",{className:"publish"},y.a.createElement("h3",null,"publish"),y.a.createElement("span",null,"topic:",y.a.createElement(d.a,{style:{width:120},type:"text",defaultValue:this.state.mqttTopic,onChange:this.handleInputChange.bind(this,"mqttTopic")})),y.a.createElement("span",null,"msg:",y.a.createElement(d.a,{style:{width:120},type:"text",defaultValue:this.state.mqttMessage,onChange:this.handleInputChange.bind(this,"mqttMessage")})),y.a.createElement("span",null,"qos:",y.a.createElement(c.a,{defaultValue:this.state.mqttQos,style:{width:60},onChange:this.handleInputChange.bind(this,"mqttQos")},y.a.createElement(c.a.Option,{value:"0"},"0"),y.a.createElement(c.a.Option,{value:"1"},"1"),y.a.createElement(c.a.Option,{value:"2"},"2"))),y.a.createElement("span",null,"retain:",y.a.createElement(c.a,{defaultValue:this.state.mqttRetain,onChange:this.handleInputChange.bind(this,"mqttRetain")},y.a.createElement(c.a.Option,{value:"0"},"false"),y.a.createElement(c.a.Option,{value:"1"},"true"))),y.a.createElement("span",{className:"btnContainer"},y.a.createElement(l.a,{type:"",disabled:this.state.btnSendDisabled,onClick:this.publish.bind(this)},"publish"))),y.a.createElement("div",{className:"subscribe"},y.a.createElement("h3",null,"subscribe"),y.a.createElement("span",null,"topic:",y.a.createElement(d.a,{style:{width:120},type:"text",defaultValue:this.state.subTopic,onChange:this.handleInputChange.bind(this,"subTopic")})),y.a.createElement("span",null,"qos:",y.a.createElement(c.a,{style:{width:60},defaultValue:this.state.subQos,onChange:this.handleInputChange.bind(this,"subQos")},y.a.createElement(c.a.Option,{value:"0"},"0"),y.a.createElement(c.a.Option,{value:"1"},"1"),y.a.createElement(c.a.Option,{value:"2"},"2"))),y.a.createElement("span",{className:"btnContainer"},y.a.createElement(l.a,{disabled:this.state.btnSubDisabled,onClick:this.subscribe.bind(this)},"subscribe"))),y.a.createElement("div",null,y.a.createElement("div",null,y.a.createElement("span",{className:"msgHeader"}," Message"),y.a.createElement(s.a,{type:"delete",onClick:this.clearMessage.bind(this)})),y.a.createElement("div",{id:"log",className:"log"})))}}]),t}(y.a.Component));t.default=S}}]);