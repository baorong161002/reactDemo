(window.webpackJsonp=window.webpackJsonp||[]).push([[15],{455:function(e,t,a){"use strict";a.d(t,"a",function(){return h});var n=a(19),s=a(20),l=a(22),i=a(18),o=a(21),r=a(1),u=a.n(r),c=a(32),f={POST:1,GET:2},h=function(e){function t(e){var a;return Object(n.a)(this,t),(a=Object(l.a)(this,Object(i.a)(t).call(this,e))).state={loading:!1},a.reqConfig={type:f.GET,url:"",reqParams:{}},a.source=null,a.setSource=function(e){a.source=e},a.setUrl=function(e){a.reqConfig.url=e},a.setOperate=function(e){a.reqConfig.type=e},a.setPostOperate=function(){a.setOperate(f.POST)},e.url&&a.setUrl(e.url),a}return Object(o.a)(t,e),Object(s.a)(t,[{key:"componentWillUnmount",value:function(){this.cancelRequest()}},{key:"cancelRequest",value:function(){if(this.source&&this.state.loading){console.log("\u7ec4\u4ef6\u5378\u8f7d,\u53d6\u6d88\u8bf7\u6c42"),this.source.cancel("\u7ec4\u4ef6\u5378\u8f7d,\u53d6\u6d88\u8bf7\u6c42")}}},{key:"requestDataExtend",value:function(e,t,a){var n=this;if(!0!==this.checkShowLoad()){this.showLoadStart();var s={};t&&Object.assign(s,t);var l=c.a.getUrl;a===f.POST&&(l=c.a.postUrl),Object.assign(this.reqConfig,{type:a,url:e,reqParams:s}),l(e,s,this.setSource).then(function(e){console.log(e.data),n.showLoadEnd(),n.processResponseData(e.data)},function(e){n.showLoadEnd(),n.processResponseError(e)})}}},{key:"requestRefresh",value:function(){this.requestDataExtend(this.reqConfig.url,this.reqConfig.reqParams,this.reqConfig.type)}},{key:"requestDataExtendPost",value:function(e,t){this.requestDataExtend(e,t,f.POST)}},{key:"requestDataExtendGet",value:function(e,t){this.requestDataExtend(e,t,f.GET)}},{key:"requestData",value:function(e){this.requestDataExtend(this.reqConfig.url,e,this.reqConfig.type)}},{key:"checkShowLoad",value:function(){return!0===this.state.loading}},{key:"showLoadStart",value:function(){this.setState({loading:!0})}},{key:"showLoadEnd",value:function(){this.setState({loading:!1})}},{key:"processResponseData",value:function(e){console.log("processResponseData:",e)}},{key:"processResponseError",value:function(e){console.log("processResponseError:",e)}}]),t}(u.a.Component)},903:function(e,t,a){"use strict";a.r(t);a(97);var n,s=a(81),l=a.n(s),i=(a(463),a(467)),o=a.n(i),r=a(20),u=a(19),c=a(22),f=a(18),h=a(21),p=(a(213),a(67)),d=a.n(p),m=a(1),b=a.n(m),g=a(136),y=a(453),v=a(455),E={ftPage:0,ftString:1,ftInteger:2,ftFloat:3,ftDate:4,ftBool:6,ftSelect:11,ftMarkEx:12,ftMark:13,ftDataListSel:15,ftMail:17,ftPwd:18,ftPwdEx:19,ftUpFile:21,ftDiff:32,ftFileSizeKb:33,ftFileSize:35,ftMultAdd:26,ftMultSel:27,ftSpecStr:28,ftUser:29,ftTree:30,ftEdtBool:41,ftVcode:60,ftALinKFldA:61,ftALinkFldB:62,ftALinkFixA:63,ftALinkFixB:64,ftAImgA:65,ftAImgB:66,ftAFldA:67,ftAFldB:68,ftChkEdt:70,ftChkDel:71,ftKey:72,ftSwitch:73,ftAud:74,ftDisUpdate:75,ftDisLink:76,ftDisString:77,ftDisBool:78,ftDisEdt:79,ftEnd:80},O=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).FieldType=E,a.itemContentElement=function(){},a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"componentDidMount",value:function(){this.props.onRef&&this.props.onRef(this)}},{key:"getRequestParam",value:function(e){return{}}}]),t}(v.a),D=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(f.a)(t).call(this,e))).reqData={reqParams:{pageNum:1,pageSize:10},rowKey:null},Object.assign(a.state,{dataList:[],columns:[],total:0,current:1,pageSize:10}),a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"componentWillMount",value:function(){this.setState({dataList:[],columns:[],total:0,current:1,pageSize:10})}},{key:"setPageNum",value:function(e){this.reqData.reqParams.pageNum=e}},{key:"setPageSize",value:function(e){this.reqData.reqParams.pageSize=e}},{key:"requestListPageData",value:function(e,t,a){e&&this.setPageNum(e),t&&(this.reqData.reqParams.pageSize=t),this.requestListData(a)}},{key:"requestQueryData",value:function(e){this.requestListData(e)}},{key:"requestListData",value:function(e){this.reqData.rowKey=null;var t=Object.assign({},this.reqData.reqParams);e&&Object.assign(t,e),console.log("params:",t),this.requestData(t)}},{key:"processResponseData",value:function(e){Object(y.a)(Object(f.a)(t.prototype),"processResponseData",this).call(this,e);var a=this.processCustomResultData(e),n={};a.list&&(n.dataList=a.list),a.columns&&(n.columns=a.columns),a.total&&(n.total=a.total),a.pageSize&&(n.pageSize=a.pageSize),a.pageNum&&(n.current=a.pageNum),a.rowKey&&(this.reqData.rowKey=a.rowKey),this.setState(n)}},{key:"processCustomResultData",value:function(e){return e}}]),t}(O),j=a(58),w=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(f.a)(t).call(this,e))).params={funKey:""},a.refreshTable=function(){a.requestFunctionData()},a.handeEditData=function(e){var t=a.reqData.rowKey;if(a.GlobalUtil.stringEmptyOrNull(t))j.a.showErrorMessage("rowkey is not define");else{var n=e[t];a.props.event&&a.props.event.editEvent&&a.props.event.editEvent(n)}},a.handeDeleteData=function(e){var t=a.reqData.rowKey;if(a.GlobalUtil.stringEmptyOrNull(t))j.a.showErrorMessage("rowkey is not define");else{var n=e[t];a.props.event&&a.props.event.deleteEvent&&a.props.event.deleteEvent(n)}},a.setPostOperate(),a.params.funKey=e.funKey,a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"requestFunctionData",value:function(){this.requestListData(this.params)}},{key:"requestInitFunctionData",value:function(e){this.GlobalUtil.stringEmptyOrNull(e)?j.a.showErrorMessage("funKey is empty or null"):(this.params.funKey=e,this.setPageNum(1),this.requestListData(this.params))}},{key:"componentWillReceiveProps",value:function(e){console.log("data funKey:",e.funKey),e.funKey&&e.funKey.length>0?this.requestInitFunctionData(e.funKey):this.requestInitFunctionData(this.props.funKey)}}]),t}(D),R=a(514),S=(a(533),function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).totalWidth=0,a.getTextRender=function(e,t,a){var n=e[t.prop];return b.a.createElement("span",{className:"nowraptext",style:{width:t.width-10+"px"}},n)},a.getUpdateRender=function(e,t,n){var s=e[t.prop],l=!1===Boolean(parseInt(s));return b.a.createElement(R.Button,{disabled:l,size:"small",type:"text",onClick:a.handeEditData.bind(Object(g.a)(a),e)},b.a.createElement("u",null,"\u7f16\u8f91"))},a.getDeleteRender=function(e,t,n){var s=e[t.prop],l=!1===Boolean(parseInt(s));return b.a.createElement(R.Button,{disabled:l,size:"small",type:"text",onClick:a.handeDeleteData.bind(Object(g.a)(a),e)},b.a.createElement("u",null,"\u5220\u9664"))},a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"processCustomResultData",value:function(e){var t={},a=this.FieldType;if(this.totalWidth=0,e.fieldListInfo){var n=[];for(var s in e.fieldListInfo){var l=e.fieldListInfo[s];if(l.extendType===a.ftKey)t.rowKey=l.fieldViewName;else{var i=l.fieldDesc,o=this.getTextRender,r={label:i,prop:l.fieldViewName,width:l.width,sortable:!0};l.extendType===a.ftChkDel&&(o=this.getDeleteRender,r.sortable=!1),l.extendType===a.ftChkEdt&&(o=this.getUpdateRender,r.sortable=!1),this.totalWidth+=r.width+1,r.render=o,n.push(r)}}n.unshift({type:"selection"}),this.totalWidth+=44,t.columns=n}return e.dataList&&(t.list=e.dataList),e.pageInfo&&(t.total=e.pageInfo.total,t.pageNum=e.pageInfo.pageNum,t.pageSize=e.pageInfo.pageSize),t}},{key:"getTableStyle",value:function(){return{width:this.totalWidth+"px",marginTop:20}}},{key:"onShowSizeChange",value:function(e){this.setPageSize(e),this.requestFunctionData()}},{key:"onCurrentChange",value:function(e){this.setPageNum(e),this.requestFunctionData()}},{key:"render",value:function(){return b.a.createElement("div",{align:"center",className:"functionTable"},b.a.createElement(R.Loading,{loading:this.state.loading,text:"\u6570\u636e\u52a0\u8f7d\u4e2d..."},b.a.createElement(R.Table,{style:this.getTableStyle(),columns:this.state.columns,height:500,maxHeight:500,stripe:!0,border:!0,highlightCurrentRow:!0,data:this.state.dataList,rowKey:this.reqData.rowKey}),b.a.createElement("div",{className:"block"},b.a.createElement(R.Pagination,{layout:"total, sizes, prev, pager, next, jumper",onSizeChange:this.onShowSizeChange.bind(this),onCurrentChange:this.onCurrentChange.bind(this),total:this.state.total,pageSizes:[10,20,30],pageSize:this.state.pageSize,currentPage:this.state.current}))))}}]),t}(w)),k=function(e){function t(){return Object(u.a)(this,t),Object(c.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return b.a.createElement(R.Dialog,{title:"\u5220\u9664",size:"tiny",visible:this.state.showFlag,onCancel:this.handleCloseShow},b.a.createElement(R.Dialog.Body,null,"\u6570\u636e\u5220\u9664\u4e2d..."))}}]),t}(function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(f.a)(t).call(this,e))).keyValue=null,a.handleCloseShow=function(){Object(y.a)(Object(f.a)(t.prototype),"cancelRequest",Object(g.a)(a)).call(Object(g.a)(a)),a.keyValue=null,a.setState({showFlag:!1}),Object(y.a)(Object(f.a)(t.prototype),"showLoadEnd",Object(g.a)(a)).call(Object(g.a)(a))},a.handleEnd=function(){a.props.event&&a.props.event.endEvent&&(a.keyValue=null,a.props.event.endEvent())},a.handleDeleteData=function(e){if(null!=e){a.keyValue=e,a.setState({showFlag:!0});var t={funKey:a.props.funKey,id:a.keyValue};console.log(t),console.log(a.props.url),a.requestDataExtendPost(a.props.url,t)}},a.state.showFlag=!1,a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"processResponseData",value:function(e){if(console.log("processResponseData:",e),e.cmmitResult)if(1===e.cmmitResult.cmmitFlag)this.handleEnd(),this.setState({showFlag:!1});else{var t="";if(e.cmmitResult.fieldErrorResult){var a=e.cmmitResult.fieldErrorResult[0];t="{0}-{1}-{2}".format(a.error,a.fieldCode,a.fieldDesc)}alert("error:"+e.cmmitResult.cmmitFlag+":"+t)}}}]),t}(O)),F=a(170),C=(a(212),a(105)),q=a.n(C),L=(a(490),a(479)),K=a.n(L),T=(a(208),a(135)),U=a.n(T),x=a(32),A=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(f.a)(t).call(this,e))).boxConfig={title:""},a.fieldListUrl="",a.showStyleFlag=1,a.showDesc="cmmit",a.showElement=null,a.getShowCmmitElement=function(){return 0===a.showStyleFlag?a.showElement:1===a.showStyleFlag?b.a.createElement(l.a,{type:"inline",onClick:a.handleOpenShow},a.showDesc):b.a.createElement(l.a,{type:"link",onClick:a.handleOpenShow},a.showDesc)},a.enableId=!1,a.keyValue=null,a.handleOpenShow=function(e){!0===a.enableId&&a.GlobalUtil.stringEmptyOrNull(a.keyValue)?alert("id value is null or empty"):(a.setState({showFlag:!0,haveField:!1,comps:[]}),a.requestFieldList())},a.handleEditData=function(e){a.GlobalUtil.stringEmptyOrNull(e)||(a.keyValue=e,a.handleOpenShow())},a.requestFieldList=function(){var e={funKey:a.props.funKey,id:a.keyValue};a.setState({loading:!0}),x.a.postUrl(a.fieldListUrl,e).then(function(e){a.setState({loading:!1}),e.data&&e.data.fieldListInfo&&(console.log("data:",e.data),a.setState({haveField:e.data.fieldListInfo.length>0,comps:e.data.fieldListInfo}),0===e.data.fieldListInfo.length&&(j.a.showErrorMessage("\u6ca1\u6709\u914d\u7f6e\u4fe1\u606f,\u8bf7\u68c0\u67e5\u914d\u7f6e"),a.handleCloseShow()))},function(){a.setState({loading:!1})})},a.handleCloseShow=function(){Object(y.a)(Object(f.a)(t.prototype),"cancelRequest",Object(g.a)(a)).call(Object(g.a)(a)),a.keyValue=null,a.setState({showFlag:!1}),Object(y.a)(Object(f.a)(t.prototype),"showLoadEnd",Object(g.a)(a)).call(Object(g.a)(a))},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,t){if(!e){console.log("Received values of form: ",t);var n={funKey:a.props.funKey,id:a.keyValue,fieldsList:t};console.log(n),a.requestDataExtendPost(a.props.url,n)}})},a.handleEnd=function(){a.props.event&&a.props.event.endEvent&&(a.keyValue=null,a.props.event.endEvent())},a.state.showFlag=!1,a.state.haveField=!1,a.state.comps=[],a.fieldListUrl=a.GlobalUtil.getObject(a.props.fieldListUrl,a.fieldListUrl),a.boxConfig.title=a.GlobalUtil.getObject(a.props.title,a.boxConfig.title),a.showStyleFlag=a.GlobalUtil.getObject(a.props.showStyleFlag,a.showStyleFlag),a.showDesc=a.GlobalUtil.getObject(a.props.showDesc,a.showDesc),a.enableId=a.GlobalUtil.getObject(a.props.enableId,a.enableId),a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"processResponseData",value:function(e){if(console.log("processResponseData:",e),e.cmmitResult)if(1===e.cmmitResult.cmmitFlag)this.handleEnd(),this.setState({showFlag:!1});else{var t="";if(e.cmmitResult.fieldErrorResult){var a=e.cmmitResult.fieldErrorResult[0];t="{0}-{1}-{2}".format(a.error,a.fieldCode,a.fieldDesc)}alert("error:"+e.cmmitResult.cmmitFlag+":"+t)}}},{key:"render",value:function(){var e=this.boxConfig,t=this.state,a=t.comps,n=t.haveField,s=this.props.form.getFieldDecorator,i=b.a.createElement(d.a.Item,null);return n&&(i=b.a.createElement(d.a.Item,{wrapperCol:{xs:{span:24,offset:0},sm:{span:16,offset:8}}},b.a.createElement(l.a,{type:"primary",onClick:this.handleSubmit},"\u63d0\u4ea4"),b.a.createElement(l.a,{onClick:this.handleCloseShow},"\u5173\u95ed"))),b.a.createElement("span",{className:"functionBotton"},this.getShowCmmitElement(),b.a.createElement(o.a,{title:e.title,visible:this.state.showFlag,onCancel:this.handleCloseShow,footer:null},b.a.createElement(U.a,{spinning:this.state.loading},b.a.createElement(d.a,Object.assign({},{labelCol:{xs:{span:22},sm:{span:4}},wrapperCol:{xs:{span:22},sm:{span:16}}},{onSubmit:this.handleSubmit}),a.map(function(e,t){return b.a.createElement(P,{key:t,data:e,getFieldDecorator:s})}),i))))}}]),t}(O),P=function(e){function t(){var e,a;Object(u.a)(this,t);for(var n=arguments.length,s=new Array(n),l=0;l<n;l++)s[l]=arguments[l];return(a=Object(c.a)(this,(e=Object(f.a)(t)).call.apply(e,[this].concat(s)))).getLinkCompoent=function(e){var t=e.queryLinkName,n=e.fieldLinkCode;if(n&&n.length>0){var s=t.split(",");if(s.length<=0)return;return a.props.getFieldDecorator(n,{initialValue:s[0]})(b.a.createElement(K.a,{style:{width:"20%"}},s.map(function(e,t){return b.a.createElement(K.a.Option,{value:e},e)})))}},a.getComponent=function(){var e=a.props.data,t=a.props.data,n=(t.mustHaveValue,t.fieldCode),s=t.fieldDesc,l=t.dataValue,i=t.inputHint;return e.fieldType,b.a.createElement(d.a.Item,{label:s},a.getLinkCompoent(e),a.props.getFieldDecorator(n,{initialValue:l})(b.a.createElement(q.a,{style:{width:"80%"},placeholder:i})))},a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"render",value:function(){return b.a.createElement("div",null,this.getComponent())}}]),t}(b.a.Component),I=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(f.a)(t).call(this,e))).handleCloseShow=function(){Object(y.a)(Object(f.a)(t.prototype),"cancelRequest",Object(g.a)(a)).call(Object(g.a)(a)),a.setState({showFlag:!1}),Object(y.a)(Object(f.a)(t.prototype),"showLoadEnd",Object(g.a)(a)).call(Object(g.a)(a))},a.handleEnd=function(){a.props.event&&a.props.event.endEvent&&a.props.event.endEvent()},a.handleExportData=function(){a.setState({showFlag:!0});var e={funKey:a.props.funKey};console.log(e),a.requestDataExtendPost(a.props.url,e)},a.state.showFlag=!1,a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"processResponseData",value:function(e){if(console.log("processResponseData:",e),e.cmmitResult)if(1===e.cmmitResult.cmmitFlag)this.handleEnd(),this.setState({showFlag:!1});else{var t="";if(e.cmmitResult.fieldErrorResult){var a=e.cmmitResult.fieldErrorResult[0];t="{0}-{1}-{2}".format(a.error,a.fieldCode,a.fieldDesc)}alert("error:"+e.cmmitResult.cmmitFlag+":"+t)}}},{key:"render",value:function(){return b.a.createElement("span",{className:"functionBotton"},b.a.createElement(l.a,{type:"inline",onClick:this.handleExportData},"\u5bfc\u51fa"),b.a.createElement(o.a,{title:"\u5bfc\u51fa",visible:this.state.showFlag,onCancel:this.handleCloseShow,footer:null},b.a.createElement(U.a,{spinning:this.state.loading,tip:"\u6570\u636e\u5bfc\u51fa\u4e2d..."})))}}]),t}(O),N=d.a.create()(n=function(e){function t(){return Object(u.a)(this,t),Object(c.a)(this,Object(f.a)(t).apply(this,arguments))}return Object(h.a)(t,e),t}(A))||n,z=function(e){function t(e){var a;return Object(u.a)(this,t),(a=Object(c.a)(this,Object(f.a)(t).call(this,e))).relationRef={tableListObj:null,queryFormObj:null,addFormObj:null,updateFormObj:null,deleteObj:null,exportObj:null,importObj:null},a.onRefQueryForm=function(e){a.relationRef.queryFormObj=e},a.onRefAddForm=function(e){a.relationRef.addFormObj=e},a.onRefUpdateForm=function(e){a.relationRef.updateFormObj=e},a.onRefTableListQuery=function(e){a.relationRef.tableListObj=e},a.onRefDelete=function(e){a.relationRef.deleteObj=e},a.onRefExport=function(e){a.relationRef.exportObj=e},a.onRefImport=function(e){a.relationRef.importObj=e},a.refreshTable=function(){a.relationRef.tableListObj.refreshTable()},a.handleEditData=function(e){a.relationRef.updateFormObj.handleEditData(e)},a.handleDeleteData=function(e){o.a.confirm({title:"",content:"\u786e\u8ba4\u8981\u5220\u9664\u6570\u636e",okText:"\u662f",okType:"danger",cancelText:"\u5426",onOk:function(){a.relationRef.deleteObj.handleDeleteData(e)}})},a.state={funKey:""},a}return Object(h.a)(t,e),Object(r.a)(t,[{key:"componentWillReceiveProps",value:function(e){e.match.params.id?this.setFunKey(e.match.params.id):this.setFunKey(this.props.match.params.id)}},{key:"componentDidMount",value:function(){this.setFunKey(this.props.match.params.id)}},{key:"setFunKey",value:function(e){if(!this.GlobalUtil.stringEmptyOrNull(e)){var t=e;console.log("set funKey:",t),this.setState({funKey:t})}}},{key:"render",value:function(){return b.a.createElement("div",null,b.a.createElement("div",{className:"functionBotton"},b.a.createElement(l.a,{type:"inline",onClick:this.refreshTable},"\u5237\u65b0"),b.a.createElement(I,{url:F.a.DATA_FUN.EXPORT,funKey:this.state.funKey,onRef:this.onRefExport}),b.a.createElement(N,{url:F.a.DATA_FUN.QUERY_CMMIT,fieldListUrl:F.a.DATA_FUN.QUERY_FIELDS,title:"\u67e5\u8be2",showDesc:"\u67e5\u8be2",funKey:this.state.funKey,onRef:this.onRefQueryForm,event:{endEvent:this.refreshTable}}),b.a.createElement(N,{url:F.a.DATA_FUN.ADD_CMMIT,fieldListUrl:F.a.DATA_FUN.ADD_FIELDS,title:"\u589e\u52a0",showDesc:"\u589e\u52a0",funKey:this.state.funKey,onRef:this.onRefAddForm,event:{endEvent:this.refreshTable}}),b.a.createElement(N,{url:F.a.DATA_FUN.UPDATE_CMMIT,fieldListUrl:F.a.DATA_FUN.UPDATE_FIELDS,title:"\u7f16\u8f91",showDesc:"\u7f16\u8f91",funKey:this.state.funKey,enableId:!0,showStyleFlag:0,onRef:this.onRefUpdateForm,event:{endEvent:this.refreshTable}})),b.a.createElement(S,{url:F.a.DATA_FUN.SELECT,funKey:this.state.funKey,onRef:this.onRefTableListQuery,event:{editEvent:this.handleEditData,deleteEvent:this.handleDeleteData}}),b.a.createElement(k,{url:F.a.DATA_FUN.DELETE,funKey:this.state.funKey,onRef:this.onRefDelete,event:{endEvent:this.refreshTable}}))}}]),t}(b.a.Component);t.default=z}}]);